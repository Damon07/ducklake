# name: test/sql/types/floats.test
# description: test ducklake floats
# group: [ducklake]

require ducklake

require parquet

statement ok
PRAGMA enable_verification

statement ok
ATTACH 'ducklake:__TEST_DIR__/ducklake.db' AS ducklake (DATA_PATH '__TEST_DIR__/ducklake_files', METADATA_CATALOG 'ducklake_meta')

statement ok
CREATE TABLE ducklake.test(f float, d DOUBLE);

statement ok
INSERT INTO ducklake.test VALUES (1, 2), (10, 3);

statement ok
INSERT INTO ducklake.test VALUES ('NaN', 0.5), (1, 3);

# predicate on NaN
query I
SELECT COUNT(*) FROM ducklake.test WHERE f='NaN'
----
1

# upper-bound requires NaN checks
# FIXME
mode skip

query I
SELECT COUNT(*) FROM ducklake.test WHERE f>1
----
2
