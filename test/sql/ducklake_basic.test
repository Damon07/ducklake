# name: test/sql/ducklake_basic.test
# description: test ducklake extension
# group: [quack]

require ducklake

require parquet

statement ok
ATTACH 'ducklake:__TEST_DIR__/ducklake.db' AS ducklake (DATA_PATH '__TEST_DIR__/ducklake_files', METADATA_CATALOG 'ducklake_meta')

statement ok
CREATE TABLE ducklake.test(i INTEGER, j INTEGER);

query II
SELECT * FROM ducklake.test
----

statement ok
INSERT INTO ducklake.test VALUES (1, 2), (NULL, 3);

query II
SELECT * FROM ducklake.test
----
1	2
NULL	3

query I
SELECT data_path.replace('__TEST_DIR__/', '') FROM ducklake_meta.ducklake_info
----
ducklake_files

statement error
ATTACH 'ducklake:__TEST_DIR__/ducklake_error.db' AS ducklake_error
----
DATA_PATH
